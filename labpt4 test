% --- SETUP (From your code) ---
mover6 = importrobot('CPMOVER6.urdf');
ik = inverseKinematics('RigidBodyTree', mover6);
weights = [0.25 0.25 0.25 1 1 1];

% 1. Define ONE Target (The "Cup of Coffee")
% We pick a random pose and lock it in. This is the goal for all attempts.
targetConfig = randomConfiguration(mover6);
targetTform = getTransform(mover6, targetConfig, 'link6', 'base_link');

disp('Target Transform defined.');

% --- LOOP FOR TASKS 4a & 4b ---
% We will try to reach this SAME target 5 times with DIFFERENT starting shapes.

figure; % Open a new window for plotting
for i = 1:5
    fprintf('\n--- Attempt #%d ---\n', i);
    
    % TASK 4b: Generate a DIFFERENT seed (initial guess)
    % This forces the math to look for solutions in different areas.
    seedConfig = randomConfiguration(mover6); 
    
    % Solve IK using the random seed
    [configSoln, solnInfo] = ik('link6', targetTform, weights, seedConfig);
    
    % TASK 4a Verification: Check if we actually reached the target
    % Calculate the transform of the solution found
    solnTform = getTransform(mover6, configSoln, 'link6', 'base_link');
    
    % Calculate distance error (Difference between Goal and Actual)
    distError = norm(targetTform(1:3,4) - solnTform(1:3,4));
    
    if distError < 0.01
        disp('Result: SUCCESS - Reached the target');
    else
        disp('Result: FAILURE - Could not reach target');
    end
    
    % VISUALIZATION
    % We plot all solutions on top of each other to see the differences
    show(mover6, configSoln, 'PreservePlot', false);
    hold on; % Keep the previous plot so we can compare
    
    % Optional: Plot the target coordinate frame to see where we are aiming
    plotTransforms(tform2trvec(targetTform), tform2quat(targetTform), 'FrameSize', 0.2);
    
    title(['Attempt ' num2str(i) ' (Look for different elbow positions)']);
    pause(1); % Pause for 1 second so you can see it happen
end
hold off;
